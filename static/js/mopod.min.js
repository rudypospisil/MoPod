var mopod={init:function(){document.getElementById("roulette").style.display="block",mopod.getGenres(),mopod.getLaterList(),mopod.getSubscriptions()},listenNotes:function(e){let t,s;s="/roulette",(t=new XMLHttpRequest).open("GET","/roulette",!0),t.send()},spinRoulette:function(){let e,t,s="",a="";t="/spinRoulette",(e=new XMLHttpRequest).open("GET","/spinRoulette",!0),e.send(),e.onreadystatechange=function(){4===e.readyState&&(jObj=JSON.parse(e.response),s=new Date(jObj.pub_date_ms),a+='<div class="row">',a+='<div class="col-12">',a+='<button onclick="mopod.spinRoulette();">Spin Again</button>',a+="<button onclick=\"mopod.insertLaterList('"+jObj.id+"');\">Save for Later</button>",a+="<button onclick=\"mopod.insertSubscription('"+jObj.podcast_id+"');\">Subscribe</button>",a+="</div>",a+="</div><br>",a+='  <div class="row">',a+='    <div class="col-12 col-lg-6">',a+='      <img class="img-fluid" src="'+jObj.thumbnail+'" />',a+="    </div>",a+='    <div class="col-12 col-lg-6">',a+='      <h1 class="podcastTitle">'+jObj.podcast_title+"</h1>",a+='      <p class="publisher">'+jObj.publisher+"</p>",a+='      <h2 class="episodeTitle"><a href="javascript: mopod.play(\''+jObj.id+"');\">"+jObj.title+"</a></h2>",a+='      <p class="pubDate">'+s+"</p>",a+='      <p class="episodeDescription">'+jObj.description+"</p>",a+="    </div>",a+="  </div>",document.getElementById("rouletteResult").innerHTML=a,document.getElementById("rouletteResult").setAttribute("data-episodeid",jObj.id),document.getElementById("rouletteResult").setAttribute("data-podcastid",jObj.podcast_id))}},getGenres:function(){let e=0,t="",s={},a=new XMLHttpRequest;a.open("GET","/getGenres",!0),a.send(),a.onreadystatechange=function(){if(4===a.readyState){for(s=JSON.parse(a.response),t+="<p>Category:</p>",e=0;e<s.length;e++)t+='<div class="genre">',t+='  <input type="radio" name="genre" value="'+s[e][0]+'" />',t+="  <label>"+s[e][1]+"</label>",t+="</div>";document.getElementById("genres").innerHTML=t}}},search:function(){let e,t,s,a=0,i=0,o=0,n="",l="",d="",c="",p=document.getElementsByName("searchType");for(i=0;i<p.length;i++)d=!0===p[i].checked?p[i].value:"episode";let r=document.getElementsByName("genre");for(o=0;o<r.length;o++)if(!0===r[o].checked){c=r[o].value;break}if(""===c)return alert("Please choose a category."),!1;e=new XMLHttpRequest,t="/search?query="+document.getElementById("searchInput").value+"&type="+d+"&genreId="+c,e.open("GET",t,!0),e.send(),e.onreadystatechange=function(){if(4===e.readyState){for(s=JSON.parse(e.response),console.log(s),n='<div class="row">',a=0;a<s.count;a++)l=new Date(s.results[a].pub_date_ms),n+='<div class="col-6 col-lg-2 searchResult" data-episodeid="'+s.results[a].id+'" data-podcastid="'+s.results[a].podcast_id+'">',n+='<img class="img-fluid" src="'+s.results[a].thumbnail+'" />',n+="<button onclick=\"mopod.insertSubscription('"+s.results[a].podcast_id+"');\">Subscribe</button>","episode"===d&&(n+="<button onclick=\"mopod.laterList('"+s.results[a].id+"');\">Save for Later</button>"),n+='<h2 class="podcastTitle">'+s.results[a].podcast_title_original+"</h2>",n+='<p class="publisher">'+s.results[a].publisher_original+"</p>",n+='<h2 class="episodeTitle">',"episode"===d&&(n+="<a href=\"javascript: mopod.play('"+s.results[a].id+"');\">"),n+=s.results[a].title_original,"episode"===d&&(n+="</a>"),n+="</h2>",n+='<p class="pubDate">'+l+"</p>",n+="</div>";n+="</div>",document.getElementById("searchResults").innerHTML=n}}},insertLaterList:function(e){let t,s;s="/insertLaterList?episodeid="+e,(t=new XMLHttpRequest).open("GET",s,!0),t.send(),t.onreadystatechange=function(){4===t.readyState&&(mopod.getLaterList(),mopod.openTab(null,"laterList"),document.getElementsByClassName("tabLinks")[3].className+=" active")}},deleteLaterList:function(e){let t,s;s="/deleteLaterList?episodeid="+e,(t=new XMLHttpRequest).open("GET",s,!0),t.send(),t.onreadystatechange=function(){4===t.readyState&&mopod.getLaterList()}},deleteSubscription:function(e){let t,s;s="/deleteSubscription?podcastid="+e,(t=new XMLHttpRequest).open("GET",s,!0),t.send(),t.onreadystatechange=function(){4===t.readyState&&mopod.getSubscriptions()}},getLaterList:function(){let e=0,t="",s={},a=new XMLHttpRequest;a.open("GET","/getLaterList",!0),a.send(),a.onreadystatechange=function(){if(4===a.readyState){for(s=JSON.parse(a.response),t='<div class="row">',e=0;e<s.length;e++)pubDate=new Date(s[e].pub_date_ms),t+='<div class="col-6 col-lg-2">',t+='  <img class="img-fluid" src="'+s[e].thumbnail+'" alt="" />',t+='  <a class="remove" href="javascript:mopod.deleteLaterList(\''+s[e].id+"')\">Remove</a>",t+='  <h2 class="podcastTitle">'+s[e].podcast.title+"</h2>",t+='    <p class="publisher">'+s[e].podcast.publisher+"</p>",t+='  <p class="episode"><a href="javascript: mopod.play(\''+s[e].id+"');\">"+s[e].title+"</a></p>",t+="  </div>";t+="</div>",document.getElementById("laterListResults").innerHTML=t}}},insertSubscription:function(e){reqObj=new XMLHttpRequest,reqUrl="/insertSubscription?podcastid="+e,reqObj.open("GET",reqUrl,!0),reqObj.send(),reqObj.onreadystatechange=function(){4===reqObj.readyState&&(mopod.getSubscriptions(),mopod.openTab(null,"subscriptions"),document.getElementsByClassName("tabLinks")[4].className+=" active")}},getSubscriptions:function(e=3){let t=0,s=0,a=0,i="",o={},n=new XMLHttpRequest;n.open("GET","/getSubscriptions",!0),n.send(),n.onreadystatechange=function(){if(4===n.readyState){for(o=JSON.parse(n.response),i='<div class="row">',i+='<div class="col-12">',i+="<p>Quantity of episodes to display per podcast... (sorted by newest first) ",i+='<input type="radio" name="episodeQty" value="1">',i+='<label for="1">1</label>',i+='<input type="radio" name="episodeQty" value="3" checked="true">',i+='<label for="3">3</label>',i+='<input type="radio" name="episodeQty" value="5">',i+='<label for="5">5</label>',i+='<input type="radio" name="episodeQty" value="10">',i+='<label for="10">10</label>',i+="</p></div>",t=0;t<o.length;t++)if(o[t]&&0!==Object.keys(o[t]).length){for(pubDate=new Date(o[t].pub_date_ms),i+='<div class="col-6 col-lg-2">',i+='  <img class="img-fluid" src="'+o[t].thumbnail+'" alt="'+o[t].description+'" />',i+='  <a class="remove" href="javascript:mopod.deleteSubscription(\''+o[t].id+"')\">Remove</a>",i+='  <h2 class="podcastTitle">'+o[t].title+"</h2>",i+='    <p class="publisher">'+o[t].publisher+"</p>",i+='  <div class="episodes">',s=0;s<e;s++)o[t].episodes[s]&&0!==Object.keys(o[t].episodes[s]).length&&(i+='  <p class="episode"><a href="javascript: mopod.play(\''+o[t].episodes[s].id+"');\">"+o[t].episodes[s].title+"</a></p>");i+="  </div>",i+="</div>"}i+="</div>",document.getElementById("subscriptionResults").innerHTML=i;let l=document.getElementsByName("episodeQty");for(a=0;a<l.length;a++)l[a].onclick=function(){mopod.getSubscriptions(this.value)}}}},play:function(e){let t,s,a="",i="";s="/getEpisode?id="+e,(t=new XMLHttpRequest).open("GET",s,!0),t.send(),t.onreadystatechange=function(){4===t.readyState&&(jObj=JSON.parse(t.response),console.log(jObj),a=new Date(jObj.pub_date_ms),i+='  <div class="row">',i+='    <div class="col-12 col-lg-6">',i+="\t\t\t<button onclick=\"mopod.insertLaterList('"+jObj.id+"');\">Save for Later</button>",i+="\t\t\t<button onclick=\"mopod.insertSubscription('"+jObj.podcast_id+"');\">Subscribe</button><br><br>",i+='      <img class="img-fluid" src="'+jObj.thumbnail+'" /><br><br>',i+='      <audio controls><source src="'+jObj.audio+'" /></audio>',i+="    </div>",i+='    <div class="col-12 col-lg-6">',i+='      <h1 class="podcastTitle">'+jObj.podcast.title+"</h1>",i+='      <p class="publisher">'+jObj.podcast.publisher+"</p>",i+='      <h2 class="episodeTitle">'+jObj.title+"</h2>",i+='      <p class="pubDate">'+a+"</p>",i+='      <p class="description">'+jObj.description+"</p>",i+="    </div>",i+="  </div>",document.getElementById("playerResult").innerHTML=i,document.getElementById("playerResult").setAttribute("data-episodeid",jObj.id),document.getElementById("playerResult").setAttribute("data-podcastid",jObj.podcast_id),mopod.openTab(null,"player"),document.getElementsByClassName("tabLinks")[0].className+=" active")}},openTab:function(e,t){var s,a,i;for(a=document.getElementsByClassName("tabContent"),s=0;s<a.length;s++)a[s].style.display="none";for(i=document.getElementsByClassName("tabLinks"),s=0;s<i.length;s++)i[s].className=i[s].className.replace(" active","");document.getElementById(t).style.display="block",null!==e&&(e.currentTarget.className+=" active")}};